{% extends 'site_receitas/base.html' %}
{% load static %}

{% block titulo %}{{ titulo_pagina }}{% endblock %}
{% block content %}
<div class="atualiza-container">
    <div class="atualiza-card">
        <!-- Header Section -->
        <div class="atualiza-header">
            <h1 class="atualiza-title">{{ titulo_pagina }}</h1>
        </div>

        <!-- Current Profile Preview -->
        <div class="current-profile-preview">
            <div class="current-avatar">
                {% if formulario.instance.foto_de_perfil %}
                    <img src="{{ formulario.instance.foto_de_perfil.url }}" alt="Foto atual" class="preview-image">
                {% else %}
                    <img src="{% static 'receitas/img/logo.png' %}" alt="Foto padr√£o" class="preview-image">
                {% endif %}
            </div>
            <div class="current-info">
                <p class="current-username">{{ formulario.instance.username }}</p>
                <p class="current-email">{{ formulario.instance.email }}</p>
            </div>
        </div>

        <!-- Form Section -->
        <form method="post" enctype="multipart/form-data" class="atualiza-form">
            <fieldset>
                {% csrf_token %}

                <!-- Username Field -->
                <div class="form-group">
                    {{ formulario.username.label_tag }}
                    {{ formulario.username }}
                    {% if formulario.username.help_text %}
                        <div class="help-text">{{ formulario.username.help_text }}</div>
                    {% endif %}
                    {% if formulario.username.errors %}
                        <div class="field-errors">{{ formulario.username.errors }}</div>
                    {% endif %}
                </div>

                <!-- Email Field -->
                <div class="form-group">
                    {{ formulario.email.label_tag }}
                    {{ formulario.email }}
                    {% if formulario.email.help_text %}
                        <div class="help-text">{{ formulario.email.help_text }}</div>
                    {% endif %}
                    {% if formulario.email.errors %}
                        <div class="field-errors">{{ formulario.email.errors }}</div>
                    {% endif %}
                </div>

                <!-- Photo Upload Field -->
                <div class="form-group photo-upload">
                    {{ formulario.foto_de_perfil.label_tag }}
                    <div class="file-upload-wrapper">
                        {{ formulario.foto_de_perfil }}
                        <div class="file-upload-info">
                            <i class="upload-icon">üìÅ</i>
                            <span class="upload-text">Clique para escolher uma nova foto</span>
                        </div>
                    </div>
                    {% if formulario.foto_de_perfil.help_text %}
                        <div class="help-text">{{ formulario.foto_de_perfil.help_text }}</div>
                    {% endif %}
                    {% if formulario.foto_de_perfil.errors %}
                        <div class="field-errors">{{ formulario.foto_de_perfil.errors }}</div>
                    {% endif %}
                </div>

                <!-- Messages -->
                {% if mensagem %}
                    <div class="atualiza-msg success">{{ mensagem }}</div>
                {% endif %}

                <!-- Form Actions -->
                <div class="form-actions">
                    <button type="submit" class="modern-btn atualiza-btn">
                        <span>Salvar Altera√ß√µes</span>
                    </button>
                    <a href="{% url 'usuarios:perfil' formulario.instance.id %}" class="modern-btn secondary-btn">
                        <span>Cancelar</span>
                    </a>
                </div>
            </fieldset>
        </form>

    </div>
</div>
{% endblock %}
