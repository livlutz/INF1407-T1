{% extends 'site_receitas/base.html' %}
{% load static %}

{% block titulo %}{{ titulo_pagina }}{% endblock %}
{% block content %}
<div class="atualiza-receita-container">
    <div class="atualiza-receita-card">
        <!-- Header Section -->
        <div class="atualiza-receita-header">
            <h1 class="atualiza-receita-title">{{ titulo_janela }}</h1>
            <p class="atualiza-receita-subtitle">Edite as informa√ß√µes da sua receita</p>
        </div>

        <!-- Current Recipe Preview -->
        {% if formulario.instance %}
        <div class="current-recipe-preview">
            <div class="current-recipe-image">
                {% if formulario.instance.foto_da_receita %}
                    <img src="{{ formulario.instance.foto_da_receita.url }}" alt="Foto atual da receita" class="preview-image">
                {% else %}
                    <div class="no-image-placeholder">
                        <i class="placeholder-icon">üì∏</i>
                        <span>Sem foto</span>
                    </div>
                {% endif %}
            </div>
            <div class="current-recipe-info">
                <h3 class="current-recipe-title">{{ formulario.instance.titulo }}</h3>
                <div class="current-recipe-meta">
                    <span class="meta-item">‚è±Ô∏è {{ formulario.instance.tempo_de_preparo }} min</span>
                    <span class="meta-item">üë• {{ formulario.instance.rendimento }} por√ß√µes</span>
                    {% if formulario.instance.categoria %}
                        <span class="meta-item">üè∑Ô∏è {{ formulario.instance.categoria }}</span>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Form Section -->
        <form method="post" enctype="multipart/form-data" class="atualiza-receita-form">
            <fieldset>
                {% csrf_token %}

                <!-- Recipe Title -->
                <div class="form-group">
                    {{ formulario.titulo.label_tag }}
                    {{ formulario.titulo }}
                    {% if formulario.titulo.help_text %}
                        <div class="help-text">{{ formulario.titulo.help_text }}</div>
                    {% endif %}
                    {% if formulario.titulo.errors %}
                        <div class="field-errors">{{ formulario.titulo.errors }}</div>
                    {% endif %}
                </div>

                <!-- Recipe Photo -->
                <div class="form-group photo-upload">
                    {{ formulario.foto_da_receita.label_tag }}
                    <div class="file-upload-wrapper">
                        {{ formulario.foto_da_receita }}
                        <div class="file-upload-info">
                            <i class="upload-icon">üì∏</i>
                            <span class="upload-text">Clique para alterar a foto da receita</span>
                        </div>
                    </div>
                    {% if formulario.foto_da_receita.help_text %}
                        <div class="help-text">{{ formulario.foto_da_receita.help_text }}</div>
                    {% endif %}
                    {% if formulario.foto_da_receita.errors %}
                        <div class="field-errors">{{ formulario.foto_da_receita.errors }}</div>
                    {% endif %}
                </div>

                <!-- Recipe Details Grid -->
                <div class="recipe-details-grid">
                    <!-- Tempo de Preparo -->
                    <div class="form-group">
                        {{ formulario.tempo_de_preparo.label_tag }}
                        {{ formulario.tempo_de_preparo }}
                        {% if formulario.tempo_de_preparo.help_text %}
                            <div class="help-text">{{ formulario.tempo_de_preparo.help_text }}</div>
                        {% endif %}
                        {% if formulario.tempo_de_preparo.errors %}
                            <div class="field-errors">{{ formulario.tempo_de_preparo.errors }}</div>
                        {% endif %}
                    </div>

                    <!-- Rendimento -->
                    <div class="form-group">
                        {{ formulario.rendimento.label_tag }}
                        {{ formulario.rendimento }}
                        {% if formulario.rendimento.help_text %}
                            <div class="help-text">{{ formulario.rendimento.help_text }}</div>
                        {% endif %}
                        {% if formulario.rendimento.errors %}
                            <div class="field-errors">{{ formulario.rendimento.errors }}</div>
                        {% endif %}
                    </div>

                    <!-- Dificuldade -->
                    <div class="form-group">
                        {{ formulario.dificuldade.label_tag }}
                        {{ formulario.dificuldade }}
                        {% if formulario.dificuldade.help_text %}
                            <div class="help-text">{{ formulario.dificuldade.help_text }}</div>
                        {% endif %}
                        {% if formulario.dificuldade.errors %}
                            <div class="field-errors">{{ formulario.dificuldade.errors }}</div>
                        {% endif %}
                    </div>

                    <!-- Categoria -->
                    <div class="form-group">
                        {{ formulario.categoria.label_tag }}
                        {{ formulario.categoria }}
                        {% if formulario.categoria.help_text %}
                            <div class="help-text">{{ formulario.categoria.help_text }}</div>
                        {% endif %}
                        {% if formulario.categoria.errors %}
                            <div class="field-errors">{{ formulario.categoria.errors }}</div>
                        {% endif %}
                    </div>
                </div>

                <!-- Ingredients -->
                <div class="form-group textarea-group">
                    {{ formulario.ingredientes.label_tag }}
                    {{ formulario.ingredientes }}
                    {% if formulario.ingredientes.help_text %}
                        <div class="help-text">{{ formulario.ingredientes.help_text }}</div>
                    {% endif %}
                    {% if formulario.ingredientes.errors %}
                        <div class="field-errors">{{ formulario.ingredientes.errors }}</div>
                    {% endif %}
                </div>

                <!-- Instructions -->
                <div class="form-group textarea-group">
                    {{ formulario.modo_de_preparo.label_tag }}
                    {{ formulario.modo_de_preparo }}
                    {% if formulario.modo_de_preparo.help_text %}
                        <div class="help-text">{{ formulario.modo_de_preparo.help_text }}</div>
                    {% endif %}
                    {% if formulario.modo_de_preparo.errors %}
                        <div class="field-errors">{{ formulario.modo_de_preparo.errors }}</div>
                    {% endif %}
                </div>

                <!-- Visibility -->
                {% if formulario.visibilidade %}
                <div class="form-group">
                    {{ formulario.visibilidade.label_tag }}
                    {{ formulario.visibilidade }}
                    {% if formulario.visibilidade.help_text %}
                        <div class="help-text">{{ formulario.visibilidade.help_text }}</div>
                    {% endif %}
                    {% if formulario.visibilidade.errors %}
                        <div class="field-errors">{{ formulario.visibilidade.errors }}</div>
                    {% endif %}
                </div>
                {% endif %}

                <!-- Messages -->
                {% if mensagem %}
                    <div class="atualiza-receita-msg success">{{ mensagem }}</div>
                {% endif %}

                <!-- Form Actions -->
                <div class="form-actions">
                    <button type="submit" class="atualiza-receita-btn">
                        <i class="btn-icon">üíæ</i>
                        <span>Salvar Altera√ß√µes</span>
                    </button>
                    <a href="{% url 'receitas:homepage' %}" class="secondary-btn">
                        <i class="btn-icon">‚Ü©Ô∏è</i>
                        <span>Cancelar</span>
                    </a>
                </div>
            </fieldset>
        </form>

    </div>
</div>
{% endblock %}